<!doctype html> <!--[if IE 9]>
<html class="no-js ie9" lang="en">
   <![endif]-->
   <html class="no-js" lang="en">
      <head>
         <meta charset="utf-8"/>
         <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
         <link rel="shortcut icon" href="http://neo4j.com/wp-content/themes/neo4jzurb/favicon.ico"/>
         <title>Neo4j Movies Example Application | Developer Resources | Neo4j Graph Database</title>
         <script type="text/javascript">
            var _kmq = _kmq || [];
            var _kmk = _kmk || 'a6a57b4b368caf34f5a6f2042eb075f9e559d779';
            function _kms(u){
                setTimeout(function(){
                    var d = document, f = d.getElementsByTagName('script')[0],
                        s = d.createElement('script');
                    s.type = 'text/javascript'; s.async = true; s.src = u;
                    f.parentNode.insertBefore(s, f);
                }, 1);
            }
            _kms('//i.kissmetrics.com/i.js');
            _kms('//doug1izaerwt3.cloudfront.net/' + _kmk + '.1.js');
         </script> <script type="text/javascript">
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            //Allow Linker
            ga('create', 'UA-1192232-34','auto', {'allowLinker': true});
            ga('send', 'pageview');

            // Load the plugin.
            ga('require', 'linker');

            // Define which domains to autoLink.
            ga('linker:autoLink', ['neo4j.org','neo4j.com','neotechnology.com','graphdatabases.com','graphconnect.com']);
         </script>
         <link rel="canonical" href="http://neo4j.com/guides/basic-data-modeling/"/>
         <meta property="og:locale" content="en_US"/>
         <meta property="og:type" content="article"/>
         <meta property="og:title" content="Basic Data Modeling - Neo4j Graph Database"/>
         <meta property="og:description" content="Please refer to the Neo4j Manual"/>
         <meta property="og:url" content="http://neo4j.com/guides/basic-data-modeling/"/>
         <meta property="og:site_name" content="Neo4j Graph Database"/>
         <link rel="alternate" type="application/rss+xml" title="Neo4j Graph Database &raquo; Feed" href="http://neo4j.com/feed/"/>
         <link rel="alternate" type="application/rss+xml" title="Neo4j Graph Database &raquo; Comments Feed" href="http://neo4j.com/comments/feed/"/>
         <link rel="alternate" type="application/rss+xml" title="Neo4j Graph Database &raquo; Basic Data Modeling Comments Feed" href="http://neo4j.com/guides/basic-data-modeling/feed/"/>
         <link rel='stylesheet' id='font-awesome-four-css' href="http://neo4j.com/wp-content/plugins/font-awesome-4-menus/css/font-awesome.min.css?ver=4.1.0" type='text/css' media='all'/>
         <link rel='stylesheet' id='foundation-css' href="http://neo4j.com/wp-content/themes/neo4jzurb/assets/css/app.css?ver=4.0.0" type='text/css' media='screen'/>
         <link rel='stylesheet' id='neo-codemirror-css' href="http://neo4j.com/wp-content/themes/neo4jzurb/assets/css/codemirror-neo.css?ver=4.0.0" type='text/css' media='screen'/>
         <script type='text/javascript'>
            /* <![CDATA[ */
            var ajax_object = {"ajaxurl":"http:\/\/neo4j.com\/wp-admin\/admin-ajax.php"};
            /* ]]> */
         </script> <script type='text/javascript' src='http://neo4j.com/wp-content/plugins/neo4j-download/js/download.js?ver=4.0.0'></script> <script type='text/javascript' src='http://neo4j.com/wp-content/plugins/jquery-updater/js/jquery-2.1.0.min.js?ver=2.1.0'></script> <script type='text/javascript' src='http://neo4j.com/wp-content/themes/neo4jzurb/assets/js/vendor/modernizr.min.js?ver=4.0.0'></script> <script type='text/javascript' src='http://neo4j.com/wp-content/themes/neo4jzurb/assets/js/foundation.min.js?ver=4.0.0'></script> <script type='text/javascript' src='http://neo4j.com/wp-content/themes/neo4jzurb/assets/js/vendor/codemirror.min.js?ver=4.0.0'></script> <script type='text/javascript' src='http://neo4j.com/wp-content/themes/neo4jzurb/assets/js/neo_codemirror.js?ver=4.0.0'></script> <script type='text/javascript' src='//use.typekit.net/rdt4xku.js?ver=4.0.0'></script> <script type='text/javascript' src='http://neo4j.com/wp-content/themes/neo4jzurb/assets/js/misc.js?ver=4.0.0'></script> <script type='text/javascript' src='http://neo4j.com/wp-content/themes/neo4jzurb/assets/js/neo_calculator_v3.js?ver=4.0.0'></script>
         <link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://neo4j.com/xmlrpc.php?rsd"/>
         <link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://neo4j.com/wp-includes/wlwmanifest.xml"/>
         <meta name="generator" content="WordPress 3.9.2"/>
         <link rel='shortlink' href="http://neo4j.com/?p=32079"/>
         <style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
      </head>
      <body>
         <div class="off-canvas-wrap">
            <div class="inner-wrap">
               <aside class="left-off-canvas-menu">
                  <ul class="off-canvas-list">
                     <li><a href="http://neo4j.com/use-cases/">Use Cases</a></li>
                     <li><a href="http://neo4j.com/customers/">Customers</a></li>
                     <li><a href="http://neo4j.com/community/">Community</a></li>
                     <li><a href="http://neo4j.com/docs/">Docs</a></li>
                     <li>
                        <div class="medium-3 columns headspace-20">
                           <div class="row collapse">
                              <div class="small-10 columns">
                                 <form role="search" method="get" id="searchform" class="searchform" action="http://neo4j.com/">
                                    <input type="text" name="s" id="s"/>
                              </div>
                              <div class="small-2 columns"> <div class="button postfix"> <input type="image" id="searchsubmit" src="http://www.neo4j.com/wp-content/themes/neo4jzurb/assets/images/searchicon.png" style="vertical-align:middle;"/> </form> </div> </div>
                           </div>
                        </div>
                     </li>
                  </ul>
               </aside>

               <article id="content" role="main">
                 <div class="row" style="padding: 10px 0 0;">
                   <div class="columns large-12" style="padding:10px 0 0;">
                   <ul class="breadcrumbs"> <li><a href="/">Developer Guides</a></li> <li><a href="./">Cypher</a></li> <li class="current"><a href="#">Introduction to Cypher</a></li> </ul>
                 </div>
                 </div>
                 <div class="row">
                   <div class="columns large-12" style="padding: 0;">
                   <h1 style="font-size:2.1rem;">Neo4j Movies Example Application</h1>
                 </div>
                 </div>
                  <section class="row" style="padding:10px 0;">

                  <div class="large-12 columns" style="padding-top:0;">


<div id="content">
<div class="sect1 "  >
    
<h3 id="_neo4j_movies_example_application">Neo4j Movies Example Application</h3>
<div class="sectionbody row">
<div class="columns medium-12">
<div class="sect2 columns medium-9" style='padding-left: 0;' >
    
<h4 id="_application">Application</h4>


<div class="paragraph">
<p>We use the existing movie and crew (actor, director, producer) dataset known from the Neo4j Browser and Neo4j Training to power this simple web application.
The application runs as a single page, that uses Javascript to access 3 HTTP endpoints in the backend to provide:</p>
</div>

<div class="ulist">


<ul>
<li>
movie search
</li>
<li>
single movie listing
</li>
<li>
graph visualization of the domain
</li>
</ul>

</div>
</div>
<div class="sect2 columns medium-9" style='padding-left: 0;' >
    
<h4 id="_domain_model">Domain Model</h4>
<div class="listingblock example-panel">
<div class="content code-panel" style="width:100%;height:auto;">
<pre>(:Movie {title,released,tagline})&lt;-[:ACTED_IN {roles}]-(actor:Person)</pre>
</div>
</div>
</div>
<div class="sect2 columns medium-9" style='padding-left: 0;' >
    
<h4 id="_webpage">Webpage</h4>


<div class="paragraph">
<p>The webpage is a single bootstrap page that uses jquery-ajax calls to access the backend and adds the returned JSON result data to HTML elements in the page.</p>
</div>



<div class="paragraph">
<p>For the search that is the <code>/search?q=query</code> endpoint whose results are added as table rows.
If you click on any of the movie titles, the side-view is populated with the movie details.</p>
</div>



<div class="paragraph">
<p>For the movie details it uses the <code>/movie/Movie%20Title</code> endpoint and the results are rendered as panel title, image source and unordered list for crew.</p>
</div>

<div class="sect3 "  >
    
<h5 id="_graph_visualization">Graph Visualization</h5>


<div class="paragraph">
<p>For the Graph Visualization we use <a href="http://d3js.org">d3.js</a>, our <code>/graph</code> endpoint already returns the data in the format of "nodes" and "links"-list that d3 can use directly.
We then apply the force-layout algorithm, render nodes as circles and relationships as lines, and add some minor styling to the visualization provide the movie title/person name as HTML title attribute to the node circles.</p>
</div>

</div>
</div>
<div class="sect2 columns medium-9" style='padding-left: 0;' >
    
<h4 id="_endpoints">Endpoints</h4>
<div class="sect3 "  >
    
<h5 id="_get_movie">Get Movie</h5>
<div class="listingblock example-panel">
<div class="content code-panel" style="width:100%;height:auto;">
<pre>// JSON object for single movie with cast
curl http://localhost:8080/movie/The%20Matrix

{"title": "The Matrix",
 "cast": [{"job": "acted", "role": ["Emil"], "name": "Emil Eifrem"}, {"job": "acted", "role": ["Agent Smith"], "name": "Hugo Weaving"}, ...
          {"job": "directed", "role": null, "name": "Andy Wachowski"}, {"job": "produced", "role": null, "name": "Joel Silver"}]}</pre>
</div>
</div>


<div class="paragraph">
<p>The Cypher query used, with the parameters <code>{title:"The Matrix"}</code></p>
</div>



<div class="paragraph">
<p>It matches the movie by title, then optionally finds all people working on that movie and returns the movie title and a crew-list consiting of a map with person-name, job identifier derived from the relationship-type and optionally a role for actors.</p>
</div>

<div class="listingblock example-panel">
<div class="content code-panel" style="width:100%;height:auto;">
<pre  class="code programlisting cm-s-neo" data-lang="cypher"><code>MATCH (movie:Movie {title:{title}})
 OPTIONAL MATCH (movie)&lt;-[r]-(person:Person)
 RETURN movie.title as title,
       collect({name:person.name,
                job:head(split(lower(type(r)),'_')),
                role:r.roles}) as cast LIMIT 1</code></pre>
</div>
</div>
</div>
<div class="sect3 "  >
    
<h5 id="_search_movies">Search Movies</h5>
<div class="listingblock example-panel">
<div class="content code-panel" style="width:100%;height:auto;">
<pre>// list of JSON objects for movie search results
curl http://localhost:8080/search?q=matrix

[{"movie": {"released": 1999, "tagline": "Welcome to the Real World", "title": "The Matrix"}},
 {"movie": {"released": 2003, "tagline": "Free your mind", "title": "The Matrix Reloaded"}},
 {"movie": {"released": 2003, "tagline": "Everything that has a beginning has an end", "title": "The Matrix Revolutions"}}]</pre>
</div>
</div>


<div class="paragraph">
<p>The Cypher query used, with the parameters <code>{query:"(?i).*matrix.*"}</code>, a case-insensitive regular expression partial match.</p>
</div>



<div class="paragraph">
<p>It matches the movies by title with a regular expression and then returns the movie nodes.
So the result of this query is a list of maps with the title, released and tagline entries.</p>
</div>

<div class="listingblock example-panel">
<div class="content code-panel" style="width:100%;height:auto;">
<pre  class="code programlisting cm-s-neo" data-lang="cypher"><code>MATCH (movie:Movie)
 WHERE movie.title =~ {query}
 RETURN movie</code></pre>
</div>
</div>
</div>
<div class="sect3 "  >
    
<h5 id="_graph_visualization_2">Graph Visualization</h5>
<div class="listingblock example-panel">
<div class="content code-panel" style="width:100%;height:auto;">
<pre>// JSON object for whole graph viz (nodes, links - arrays)
curl http://localhost:8080/graph[?limit=50]

{"nodes":
  [{"title":"Apollo 13","label":"movie"},{"title":"Kevin Bacon","label":"actor"},
   {"title":"Tom Hanks","label":"actor"},{"title":"Gary Sinise","label":"actor"},
   {"title":"Ed Harris","label":"actor"},{"title":"Bill Paxton","label":"actor"}],
 "links":
  [{"source":1,"target":0},{"source":2,"target":0},{"source":3,"target":0},
   {"source":4,"target":0},{"source":5,"target":0}]}</pre>
</div>
</div>


<div class="paragraph">
<p>The Cypher query used finds all pairs of movies and actors and returns the movie title and a collection of all actor names as cast.
A separate function then takes this result and converts it into the node- and link-list that d3 expects.</p>
</div>



<div class="paragraph">
<p>The parameter <code>{limit:50}</code> is used to prevent the visualization from becoming a hairball.</p>
</div>

<div class="listingblock example-panel">
<div class="content code-panel" style="width:100%;height:auto;">
<pre  class="code programlisting cm-s-neo" data-lang="cypher"><code>MATCH (m:Movie)&lt;-[:ACTED_IN]-(a:Person)
 RETURN m.title as movie, collect(a.name) as cast
 LIMIT {limit}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2 columns medium-9" style='padding-left: 0;' >
    
<h4 id="_data_setup">Data Setup</h4>


<div class="paragraph">
<p>Start your local Neo4j Server (<a href="http://neo4j.com/download">Download &amp; Install</a>), open the <a href="http://localhost:7474">Neo4j Browser</a>.
Then install the Movies data-set with <code>:play movies</code>, click the create statement, and hit the triangular "Run" button to insert the data.</p>
</div>



<div class="paragraph">
<p>You can also choose to use a cloud hosted Neo4j database, then you have to provide the URL to your Neo4j server in an environment variable <code>NEO4J_URL</code>.</p>
</div>

</div>
<div class="sect2 columns medium-9" style='padding-left: 0;' >
    
<h4 id="_run_locally">Run locally</h4>


<div class="paragraph">
<p>Then setup and start the language/stack specific implementation of the backend and open the web-application on <code><a href="http://localhost:8080" class="bare">http://localhost:8080</a></code>.</p>
</div>



<div class="paragraph">
<p>You can search for movies by title or and click on any result entry to see the details.</p>
</div>

</div>
<div class="sect2 columns medium-9" style='padding-left: 0;' >
    
<h4 id="_deploy_to_heroku">Deploy to Heroku</h4>


<div class="paragraph">
<p>We want to install our application to the cloud, for instance the <a href="http://heroku.com">Heroku</a> PaaS.
We will also use the <a href="http://graphenedb.com">GraphenDB</a> Neo4j Database Hosting Add-On.</p>
</div>



<div class="paragraph">
<p>Install the <a href="https://toolbelt.heroku.com/">Heroku Toolbelt</a> and git.</p>
</div>



<div class="paragraph">
<p>Then run these commands</p>
</div>

<div class="listingblock example-panel">
<div class="content code-panel" style="width:100%;height:auto;">
<pre  class="code programlisting cm-s-neo" data-lang="shell"><code># initialize git repository and add files
git init
git add .
git commit -m"my neo4j movies app"

# create heroku application, please change the app-name
export app=my-neo4j-movies-app
heroku apps:create $app

# add free graphenedb hosting
heroku addons:add graphenedb:chalk --app $app

# configure your app to use the add-on
heroku config:set NEO4J_REST_URL=GRAPHENEDB_URL --app $app

# deploy to heroku
git push heroku master

# open application
heroku open --app $app

# open addon admin page
heroku addons:open graphenedb</code></pre>
</div>
</div>


<div class="paragraph">
<p>In the Graphenedb-UI use "Launch Neo4j Admin UI".
In the Neo4j-Browser import the <code>:play movies</code> dataset as of the install instructions above.</p>
</div>



<div class="paragraph">
<p>Then your app is ready to roll.</p>
</div>

</div>
</div>
</div>

</div>
</div>

</div>
</section>


            </article>
      <script>
         jQuery(document).foundation({
           tab: {
             callback : function (tab) {
               $(window).trigger('resize');
             }
           }
         });
      </script>
   </body>
</html>